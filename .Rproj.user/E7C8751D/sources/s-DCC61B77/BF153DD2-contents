% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mainSPAC.R
\name{SPAC}
\alias{SPAC}
\title{A flexible copula-based approach for the analysis of secondary phenotypes in presence ascertained samples}
\usage{
SPAC(y1 = NULL, y2 = NULL, G = NULL, covariates = NULL,
  prev = NULL, cutoffs = NULL, link = "probit",
  copfit = "Gaussian", method = "pros", Design = "CC")
}
\arguments{
\item{y1}{vector designates the primary phenotype (one row-entry per individual), of
length \eqn{n}.}

\item{y2}{vector designates the secondary phenotype (one row-entry per individual), of
length \eqn{n}.}

\item{G}{vector deignates the SNP of interest for
which the association test specified by the \code{method}
parameter should be run. The vector has length \eqn{n}.}

\item{covariates}{matrix of covariates NOT-including intercept (dimension:
\eqn{n \times p}, with \eqn{p} the number of covariates).}

\item{prev}{scalar between 0 and 1, specifies the primary phenotype prevalance.
It is needed for the \code{method} = "prosp" and \code{Design} equals "CC" or "MT".
Default is \code{prev} = NULL. If it is not specified, it will be estimated form the data.}

\item{cutoffs}{vector or scalar, depending on the sampling mechanism design \code{Design}.
 Can be one of the following:
\itemize{
\item \code{c(ylb,yub)}, a vector of length \eqn{2} for the extreme-trait sampling design, if \code{Design = "ET"}.
ylb, yub:  the lower (ylb) and the upper (yub) primary trait thresholds
\item \code{yub}, a scalar for the muliple-trait sampling design, if \code{Design = "MT"}.
yub: the upper (yub) secondary trait threshold.
}}

\item{link}{character, specifies the link function to be used for modelling the marginal distribution of the binary primary phenotype for the CC and MT designs.
The available link functions are link=c("probit","logit","cloglog"). The defaut is link = "probit", which th liabiltiy latent model.}

\item{copfit}{character, selects the copula to use for modelling priamry-secondary phenptypes dependence.
Can be one of the following:
\itemize{
\item \code{"Gaussian"} (default)
\item \code{"Student"}, Student copula with degree of freedom equals 10
\item \code{"Clayton"}, Clayton copula
\item \code{"Gumbel"}, Gumbel copula
\item \code{"Frank"}, Frank copula
}}

\item{method}{character, selects the method to use for correcting the sampling mechanism bias. Can be one of the following:
\itemize{
\item \code{"pros"} (default), copula-based prospective method
\item \code{"retros"}, copula-based retrospective method.
Since the copula-based restrspective method does not take into account for the covariates, if the user specifies method="retros",
in presence of cavariates, the latter will simply be ignored from the analysis
}}

\item{Design}{character, specifies the sampling design of the data.
Can be one of the following:
\itemize{
\item \code{"CC"} (default), for the Case-Control sampling mechanism
\item \code{"ET"}, for the Extreme-Trait sampling mechanism
\item \code{"MT"}, for the Multiple-Trait sampling mechanism
}}
}
\value{
A list containing results of the association test
    specified by the \code{method} parameter using the copula model for modelling primary-secondary dependency
    by the \code{copfit} parameter for the sampling mechanism \code{Design}. The
    output list contains the following results:
    \itemize{
    \item \code{intercept.SNP.SecP}: the intercept estimate from the marginal model of the secondary phenotype, and its standard error
    \item \code{SNP.SecP}: the effect size estimate of the SNP on the secondary phenotype, and its standard error
    \item \code{P.value.SecP}: the p-value of the SNP/secondary phenotype association test
    \item \code{intercept.SNP.PrP}: the intercept estimate from the marginal mode of the primamry phenotype, and its standard error
    \item \code{SNP.PrP}: the effect size estimate of the SNP on the primamry phenotype, and its standard error
    \item \code{P.value.PrP}: the p-value of the SNP/primary phenotype association test
    \item \code{alpha}: the estimated primary-secondary dependence parameter, as a parameter of the used copula
    \item \code{tau}: Kendall's tau, which is a function of the estimated primary-secondary dependence parameter alpha
    \item \code{df2}: the estimated degree of freedom of the secondary-phenotype marginal distribution, Student-t
    \item \code{AIC}: the AIC criterion calculated based on the prospective or rterospective copula-model
    }
}
\description{
Main function of the SPAC package
}
\details{
The SPAC function is the main function of the SPAC
used package.
}
\author{
Karim Oualkacha
}
